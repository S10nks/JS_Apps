<!DOCTYPE html>
<html>
<head>
  <title>To-Do List</title>
  <link rel="stylesheet" href="style.css">

  <style>

@import url('https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap');

body {
    font-family: "SUSE";
    text-align: left;
    height: 100000vh;
    background: url(Images/background.png) center center no-repeat;
    background-size: cover;
}

nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 5vh 0;
}

nav > a {
    color: #f1f1f1;
    font-size: 5vh;
    text-decoration: none;
}

ul {
    list-style: none;
    padding: 0;
    color: #f1f1f1;
}

li {
    margin-bottom: 10px;
    color: #f1f1f1;
    font-size: 3vh;
}

hr {
    color: red;
    background-color: red;
}

.completed {
    text-decoration: line-through;
    color: yellow;
}

option {
    width: 5vh;
}

.H {
    background-color: red;
    color: black;
    position: absolute;
    left: 29%;
}

.M {
    background-color: orange;
    color: black;
    position: absolute;
    left: 29%;
}

.L {
    background-color: blue;
    color: white;
    position: absolute;
    left: 29%;
}

input#newTask {
    position: sticky;
    top: 90%;
    left: 65%;
    height: 5vh;
    font-size: 3vh;
    outline: none;
    border: hidden;
    border-radius: .7vh;
}

select {
    position: sticky;
    top: 90%;
    left: 85%;
    height: 5vh;
    font-size: 3vh;
    outline: none;
    border: hidden;
    border-radius: .7vh;
}

button#addTaskBtn {
    position: sticky;
    top: 90%;
    left: 95%;
    height: 5vh;
    font-size: 3vh;
    outline: none;
    border: hidden;
    border-radius: .7vh;
}

button.completeBtn {
    position: absolute;
    left: 32%;
    font-size: 3vh
}

span.added {
    position: absolute;
    left: 20%;
}

button.deleteBtn {
    position: absolute;
    left: 40%;
    font-size: 3vh
}
  </style>

</head>
<body>

  <nav>
    <a href="">To-Do List</a>
    <a href="">September 2024</a>
  </nav>

  <hr>

  <input type="text" id="newTask" placeholder="Enter new task">

  <select id="priority">
    <option value="H">High</option>
    <option value="M">Medium</option>
    <option value="L">Low</option>
  </select>

  <button id="addTaskBtn">Add Task</button>

  <ol id="taskList">
  </ol>

  <script>
    const taskList = document.getElementById('taskList');
    const newTaskInput = document.getElementById('newTask');
    const prioritySelect = document.getElementById('priority');
    const addTaskBtn = document.getElementById('addTaskBtn');

    // Load tasks from localStorage
    window.addEventListener('load', loadTasksFromStorage);

    function loadTasksFromStorage() {
      const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
      tasks.forEach(task => {
        addTaskToDOM(task.text, task.priority, task.date, task.completed);
      });
    }

    function addTaskToDOM(taskText, priority, taskDate, completed) {
      const taskItem = document.createElement('li');
      taskItem.classList.toggle('completed', completed);
      taskItem.innerHTML = `
        <span>${taskText}</span>
        <span class="${priority}">${priority}</span>
        <span class="added">${taskDate}</span>
        <button class="completeBtn">Complete</button>
        <button class="deleteBtn">Delete</button>
      `;
      taskList.appendChild(taskItem);

      const completeBtn = taskItem.querySelector('.completeBtn');
      completeBtn.addEventListener('click', () => {
        taskItem.classList.toggle('completed');
        updateTaskInStorage(taskText, taskItem.classList.contains('completed'));
      });

      const deleteBtn = taskItem.querySelector('.deleteBtn');
      deleteBtn.addEventListener('click', () => {
        removeTaskFromDOM(taskItem);
        removeTaskFromStorage(taskText);
      });
    }

    function saveTaskToStorage(taskText, priority, taskDate, completed) {
      const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
      tasks.push({ text: taskText, priority: priority, date: taskDate, completed: completed });
      localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    function updateTaskInStorage(taskText, completed) {
      const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
      const taskIndex = tasks.findIndex(task => task.text === taskText);
      if (taskIndex !== -1) {
        tasks[taskIndex].completed = completed;
        localStorage.setItem('tasks', JSON.stringify(tasks));
      }
    }

    function removeTaskFromDOM(taskItem) {
      taskList.removeChild(taskItem);
    }

    function removeTaskFromStorage(taskText) {
      const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
      const taskIndex = tasks.findIndex(task => task.text === taskText);
      if (taskIndex !== -1) {
        tasks.splice(taskIndex, 1);
        localStorage.setItem('tasks', JSON.stringify(tasks));
      }
    }

    addTaskBtn.addEventListener('click', () => {
      const taskText = newTaskInput.value;
      const priority = prioritySelect.value;
      const taskDate = new Date().toLocaleDateString();
      if (taskText !== '') {
        addTaskToDOM(taskText, priority, taskDate, false);
        saveTaskToStorage(taskText, priority, taskDate, false);
        newTaskInput.value = '';
        prioritySelect.value = 'H'; // Reset priority to high
      }
    });

  </script>

</body>
</html>